<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Juego de ReflexiÃ³n Parental</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #e0f2fe; /* Lighter blue background */
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 1rem;
            box-sizing: border-box;
        }
        .game-container {
            background-color: #ffffff;
            border-radius: 1.5rem; /* More rounded corners */
            box-shadow: 0 12px 30px rgba(0, 0, 0, 0.15); /* Stronger shadow */
            padding: 2.5rem; /* Increased padding */
            max-width: 95%; /* Wider on smaller screens */
            width: 600px; /* Max width */
            text-align: center;
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
            position: relative; /* For confetti */
            border: 2px solid #93c5fd; /* Light blue border */
        }
        .btn {
            @apply px-7 py-3.5 rounded-xl font-semibold transition-all duration-300 ease-in-out shadow-lg transform hover:scale-105 active:scale-95; /* More prominent buttons */
        }
        .btn-primary {
            @apply bg-blue-600 text-white hover:bg-blue-700 focus:outline-none focus:ring-4 focus:ring-blue-300;
        }
        .btn-option {
            @apply bg-blue-50 text-blue-800 hover:bg-blue-100 focus:outline-none focus:ring-2 focus:ring-blue-200 w-full text-left border border-blue-200; /* Lighter options */
        }
        .btn-option.selected {
            @apply bg-blue-200 border-blue-500;
        }
        .btn-option.correct {
            @apply bg-green-200 border-green-500 text-green-800;
        }
        .btn-option.incorrect {
            @apply bg-red-200 border-red-500 text-red-800;
        }
        .progress-bar {
            @apply h-2.5 bg-blue-300 rounded-full mt-5; /* Thicker progress bar */
        }
        .progress-fill {
            @apply h-full bg-blue-600 rounded-full transition-all duration-500 ease-in-out;
        }
        .fade-in {
            animation: fadeIn 0.6s ease-out forwards;
        }
        .fade-out {
            animation: fadeOut 0.6s ease-out forwards;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(15px); }
            to { opacity: 1; transform: translateY(0); }
        }
        @keyframes fadeOut {
            from { opacity: 1; transform: translateY(0); }
            to { opacity: 0; transform: translateY(15px); }
        }

        /* Confetti animation */
        .confetti {
            position: absolute;
            width: 10px;
            height: 10px;
            background-color: #f0f; /* Pink */
            opacity: 0;
            animation: confetti-fall 3s ease-out forwards;
            pointer-events: none;
            border-radius: 50%;
        }
        .confetti:nth-child(2n) { background-color: #0ff; /* Cyan */ }
        .confetti:nth-child(3n) { background-color: #ff0; /* Yellow */ }
        .confetti:nth-child(4n) { background-color: #f00; /* Red */ }
        .confetti:nth-child(5n) { background-color: #0f0; /* Green */ }
        .confetti:nth-child(6n) { background-color: #8a2be2; /* BlueViolet */ } /* Added more colors */
        .confetti:nth-child(7n) { background-color: #ffa500; /* Orange */ }

        @keyframes confetti-fall {
            0% { opacity: 1; transform: translateY(0) rotate(0deg); }
            100% { opacity: 0; transform: translateY(500px) rotate(720deg); }
        }

        /* Image styling */
        .start-image {
            max-width: 100%;
            height: auto;
            border-radius: 1rem;
            margin-bottom: 1.5rem;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
        }
    </style>
</head>
<body>
    <div id="gameContainer" class="game-container">
        <!-- Start Screen -->
        <div id="startScreen" class="fade-in">
            <h1 class="text-4xl font-extrabold text-blue-700 mb-5">ðŸŒŸ Juego de Competencias Parentales ðŸŒŸ</h1>
            <img src="https://placehold.co/600x350/E0F2FE/3B82F6?text=Creciendo+Juntos" alt="IlustraciÃ³n de una familia feliz creciendo junta" class="start-image">
            <p class="text-lg text-gray-700 mb-6">Un espacio para reflexionar y fortalecer tus habilidades en la crianza con buen trato y modelos de crianza positivos.</p>
            <button id="startButton" class="btn btn-primary">Â¡Empezar Aventura!</button>
            <div class="mt-8 text-sm text-gray-500">
                <p>FAE San Bernardo</p>
                <p>Creado por Juan SepÃºlveda</p>
            </div>
        </div>

        <!-- Quiz Screen -->
        <div id="quizScreen" class="hidden fade-in">
            <div class="text-xl font-semibold text-blue-600 mb-3" id="questionNumber"></div>
            <h2 id="questionText" class="text-2xl font-bold text-gray-800 mb-8 leading-relaxed"></h2>
            <div id="optionsContainer" class="grid grid-cols-1 gap-4 mb-7">
                <!-- Options will be dynamically loaded here -->
            </div>
            <div id="feedbackContainer" class="p-5 rounded-xl text-left hidden mb-5 border-l-4 border-blue-500 bg-blue-50">
                <p id="feedbackText" class="font-bold text-lg mb-2 text-blue-800"></p>
                <p id="reflectionText" class="text-sm leading-relaxed text-gray-700"></p>
            </div>
            <button id="nextButton" class="btn btn-primary w-full hidden">Siguiente Pregunta ðŸ’ª</button>
            <div class="progress-bar">
                <div id="progressFill" class="progress-fill" style="width: 0%;"></div>
            </div>
        </div>

        <!-- End Screen -->
        <div id="endScreen" class="hidden fade-in">
            <h2 class="text-4xl font-bold text-blue-700 mb-4">Â¡Gran Trabajo! ðŸŽ‰</h2>
            <p class="text-xl text-gray-700 mb-4">Tu puntuaciÃ³n final: <span id="finalScore" class="font-bold text-green-600"></span></p>
            <p class="text-gray-600 mb-6" id="finalReflection"></p>
            <p class="text-blue-600 font-semibold italic text-lg mb-8" id="motivationalQuote"></p>
            <button id="restartButton" class="btn btn-primary">Volver a Jugar</button>
            <div class="mt-8 text-sm text-gray-500">
                <p>FAE San Bernardo</p>
                <p>Creado por Juan SepÃºlveda</p>
            </div>
        </div>
    </div>

    <script>
        const questions = [
            {
                question: "Â¿CuÃ¡l es la base fundamental para construir una relaciÃ³n sÃ³lida y de confianza con tu hijo/a?",
                options: [
                    "Darle todo lo que pide para que sea feliz.",
                    "La comunicaciÃ³n abierta y la escucha activa.",
                    "Controlar todas sus decisiones para protegerlo.",
                    "Evitar cualquier conflicto o desacuerdo."
                ],
                answer: "La comunicaciÃ³n abierta y la escucha activa.",
                reflection: "La escucha activa y la comunicaciÃ³n genuina son el pilar de una relaciÃ³n parental fuerte. Permiten entender las necesidades y sentimientos de tu hijo/a, fomentando un vÃ­nculo de confianza mutua."
            },
            {
                question: "Cuando tu hijo/a expresa una emociÃ³n intensa (tristeza, enojo), Â¿cÃ³mo puedes demostrar empatÃ­a?",
                options: [
                    "Decirle que no es para tanto lo que siente.",
                    "Distraerlo inmediatamente con algo divertido.",
                    "Reconocer y nombrar su emociÃ³n ('Veo que estÃ¡s triste/enojado').",
                    "Ignorar la emociÃ³n para que aprenda a controlarse solo."
                ],
                answer: "Reconocer y nombrar su emociÃ³n ('Veo que estÃ¡s triste/enojado').",
                reflection: "Validar las emociones de tus hijos/as les enseÃ±a que sus sentimientos son importantes y que es natural sentirlos. Esto es clave para su desarrollo emocional y para que aprendan a gestionarlos saludablemente."
            },
            {
                question: "Â¿QuÃ© beneficio tiene establecer lÃ­mites claros y consistentes para los niÃ±os/as?",
                options: [
                    "Restringe su libertad y creatividad.",
                    "Les proporciona seguridad y les ayuda a entender las expectativas.",
                    "Fomenta la rebeldÃ­a y el desafÃ­o a la autoridad.",
                    "Hace que los padres se vean mÃ¡s autoritarios."
                ],
                answer: "Les proporciona seguridad y les ayuda a entender las expectativas.",
                reflection: "Los lÃ­mites son como un mapa: guÃ­an a los niÃ±os/as y les dan un sentido de seguridad. Saber quÃ© esperar les permite explorar el mundo con confianza y desarrollar autodisciplina."
            },
            {
                question: "Â¿CÃ³mo puedes fomentar la autonomÃ­a en tu hijo/a de manera efectiva?",
                options: [
                    "Haciendo todo por ellos para evitar errores.",
                    "PermitiÃ©ndoles tomar decisiones apropiadas para su edad.",
                    "DiciÃ©ndoles exactamente quÃ© hacer en cada momento.",
                    "Resolviendo todos sus problemas sin que ellos intervengan."
                ],
                answer: "PermitiÃ©ndoles tomar decisiones apropiadas para su edad.",
                reflection: "Fomentar la autonomÃ­a es dar alas a tus hijos/as para que aprendan a volar. Permitirles tomar pequeÃ±as decisiones y enfrentar desafÃ­os adecuados a su edad, les prepara para ser adultos capaces y seguros."
            },
            {
                question: "Â¿QuÃ© es un ejemplo de disciplina positiva?",
                options: [
                    "Castigos fÃ­sicos o gritos cuando se portan mal.",
                    "Ignorar el mal comportamiento con la esperanza de que desaparezca.",
                    "Explicar las consecuencias de sus actos y buscar soluciones juntos.",
                    "Amenazar con quitarles cosas que les gustan."
                ],
                answer: "Explicar las consecuencias de sus actos y buscar soluciones juntos.",
                reflection: "La disciplina positiva se enfoca en enseÃ±ar y guiar, no solo en castigar. Al explicar y buscar soluciones, ayudas a tus hijos/as a desarrollar su conciencia, empatÃ­a y habilidades para resolver problemas."
            },
            {
                question: "Â¿Por quÃ© es importante el juego en el desarrollo de las competencias parentales?",
                options: [
                    "Es una forma de mantenerlos ocupados para que no molesten.",
                    "Permite la conexiÃ³n, el aprendizaje y la resoluciÃ³n de conflictos de forma lÃºdica.",
                    "Solo sirve para el entretenimiento y no tiene valor educativo.",
                    "Demuestra que los padres son permisivos."
                ],
                answer: "Permite la conexiÃ³n, el aprendizaje y la resoluciÃ³n de conflictos de forma lÃºdica.",
                reflection: "El juego es el lenguaje universal de los niÃ±os/as. A travÃ©s de Ã©l, se fortalece el vÃ­nculo, se desarrollan habilidades cognitivas y sociales, y se resuelven desafÃ­os de manera divertida y significativa."
            },
            {
                question: "Â¿QuÃ© significa ser un modelo a seguir para tus hijos/as?",
                options: [
                    "Ser perfecto/a y nunca cometer errores.",
                    "Demostrar los valores y comportamientos que deseas que ellos aprendan.",
                    "Dejar que aprendan por sÃ­ mismos sin tu guÃ­a.",
                    "Exigirles lo que tÃº no estÃ¡s dispuesto/a a hacer."
                ],
                answer: "Demostrar los valores y comportamientos que deseas que ellos aprendan.",
                reflection: "Tus acciones hablan mÃ¡s fuerte que tus palabras. Ser un modelo a seguir significa vivir los valores que quieres inculcar, mostrando coherencia y autenticidad en tu dÃ­a a dÃ­a."
            },
            {
                question: "Â¿CÃ³mo puedes ayudar a tu hijo/a a desarrollar la resiliencia?",
                options: [
                    "Evitando que experimente cualquier dificultad o fracaso.",
                    "Resolviendo siempre todos sus problemas.",
                    "EnseÃ±Ã¡ndole a manejar la frustraciÃ³n y a buscar soluciones ante los desafÃ­os.",
                    "Subestimando sus capacidades para que no se arriesgue."
                ],
                answer: "EnseÃ±Ã¡ndole a manejar la frustraciÃ³n y a buscar soluciones ante los desafÃ­os.",
                reflection: "La resiliencia no es evitar caer, sino aprender a levantarse. Al permitir que tus hijos/as enfrenten desafÃ­os con tu apoyo, les equipas con la fortaleza y la confianza para superar obstÃ¡culos futuros."
            },
            {
                question: "Â¿QuÃ© importancia tiene el autocuidado parental?",
                options: [
                    "Es un lujo egoÃ­sta que quita tiempo a los hijos.",
                    "Permite a los padres recargar energÃ­as para ser mÃ¡s pacientes y efectivos.",
                    "Demuestra debilidad y falta de compromiso.",
                    "No tiene ningÃºn impacto en la crianza."
                ],
                answer: "Permite a los padres recargar energÃ­as para ser mÃ¡s pacientes y efectivos.",
                reflection: "Cuidar de ti mismo/a no es egoÃ­smo, es una necesidad. Un padre o madre descansado/a y emocionalmente regulado/a tiene mÃ¡s paciencia, energÃ­a y capacidad para responder a las demandas de la crianza de forma positiva."
            },
            {
                question: "Â¿CuÃ¡l es una seÃ±al de que estÃ¡s practicando la escucha activa con tu hijo/a?",
                options: [
                    "Interrumpirlo/a para darle tu opiniÃ³n.",
                    "Estar mirando el telÃ©fono mientras te habla.",
                    "Mantener contacto visual, asentir y resumir lo que te dice.",
                    "Preparar tu respuesta mientras Ã©l/ella aÃºn estÃ¡ hablando."
                ],
                answer: "Mantener contacto visual, asentir y resumir lo que te dice.",
                reflection: "La escucha activa es un regalo. Le muestra a tu hijo/a que su voz importa y que sus pensamientos y sentimientos son dignos de tu atenciÃ³n plena, fortaleciendo su autoestima y confianza en sÃ­ mismo/a."
            },
            {
                question: "Â¿Por quÃ© es importante reconocer y celebrar los pequeÃ±os logros de tu hijo/a?",
                options: [
                    "Para que se vuelva dependiente de tu aprobaciÃ³n.",
                    "Refuerza su autoestima y motivaciÃ³n para seguir esforzÃ¡ndose.",
                    "Genera una expectativa de recompensa constante.",
                    "Desarrolla el narcisismo."
                ],
                answer: "Refuerza su autoestima y motivaciÃ³n para seguir esforzÃ¡ndose.",
                reflection: "Cada pequeÃ±o logro es un paso gigante en el desarrollo de tu hijo/a. Celebrarlos, por insignificantes que parezcan, construye una base sÃ³lida de autoestima y les anima a seguir aprendiendo y creciendo."
            },
            {
                question: "Â¿CÃ³mo se aborda un berrinche o pataleta desde una perspectiva de buen trato?",
                options: [
                    "Gritando para que se calle inmediatamente.",
                    "IgnorÃ¡ndolo/a por completo hasta que se calme solo/a.",
                    "Ofreciendo consuelo, nombrando la emociÃ³n y estableciendo lÃ­mites si es necesario.",
                    "Cediendo a todas sus demandas para que se calme."
                ],
                answer: "Ofreciendo consuelo, nombrando la emociÃ³n y estableciendo lÃ­mites si es necesario.",
                reflection: "Un berrinche es una seÃ±al de que tu hijo/a estÃ¡ abrumado/a. Ofrecer consuelo y lÃ­mites claros les ayuda a sentirse seguros/as y a aprender a regular sus emociones de forma constructiva."
            },
            {
                question: "Â¿QuÃ© papel juega la coherencia en la crianza?",
                options: [
                    "Es innecesaria, los niÃ±os se adaptan a cualquier cosa.",
                    "Crea confusiÃ³n y desorientaciÃ³n en los niÃ±os.",
                    "Les proporciona un marco estable y predecible, fomentando la seguridad.",
                    "Hace que la crianza sea demasiado rÃ­gida."
                ],
                answer: "Les proporciona un marco estable y predecible, fomentando la seguridad.",
                reflection: "La coherencia es como un ancla para tus hijos/as. Les da estabilidad y les permite entender las reglas del mundo que les rodea, construyendo un sentido de seguridad y confianza."
            },
            {
                question: "Â¿CÃ³mo se promueve el pensamiento crÃ­tico en los niÃ±os/as?",
                options: [
                    "DÃ¡ndoles siempre la respuesta correcta directamente.",
                    "AnimÃ¡ndolos a hacer preguntas y a buscar sus propias soluciones.",
                    "Solo enseÃ±Ã¡ndoles a memorizar datos.",
                    "ReprendiÃ©ndolos cuando cuestionan algo."
                ],
                answer: "AnimÃ¡ndolos a hacer preguntas y a buscar sus propias soluciones.",
                reflection: "El pensamiento crÃ­tico es una herramienta poderosa. Alentar a tus hijos/as a cuestionar, explorar y resolver problemas por sÃ­ mismos, les prepara para enfrentar los desafÃ­os de la vida con ingenio y creatividad."
            },
            {
                question: "Â¿CuÃ¡l es una forma efectiva de fomentar la cooperaciÃ³n en el hogar?",
                options: [
                    "Asignar tareas sin explicaciÃ³n y esperar obediencia inmediata.",
                    "Invitar a los hijos/as a participar en las decisiones familiares y tareas adecuadas a su edad.",
                    "Hacerlo todo tÃº mismo/a para evitar discusiones.",
                    "Pagarles por cada tarea que realicen."
                ],
                answer: "Invitar a los hijos/as a participar en las decisiones familiares y tareas adecuadas a su edad.",
                reflection: "La cooperaciÃ³n florece cuando todos se sienten parte del equipo. Involucrar a tus hijos/as en las responsabilidades familiares les enseÃ±a sobre el trabajo en equipo, la responsabilidad y el valor de contribuir al hogar."
            },
            {
                question: "Â¿Por quÃ© es fundamental que los padres reflexionen sobre sus propios modelos de crianza heredados?",
                options: [
                    "Para justificar sus propias acciones pasadas.",
                    "Para repetir exactamente lo que hicieron sus padres.",
                    "Para identificar patrones positivos y negativos y elegir conscientemente cÃ³mo criar.",
                    "No es necesario, cada generaciÃ³n es diferente."
                ],
                answer: "Para identificar patrones positivos y negativos y elegir conscientemente cÃ³mo criar.",
                reflection: "La reflexiÃ³n es el primer paso hacia el cambio y el crecimiento. Al entender cÃ³mo fuimos criados, podemos elegir conscientemente quÃ© queremos replicar y quÃ© queremos transformar para el bienestar de nuestros hijos/as."
            },
            {
                question: "Â¿CÃ³mo puedes ayudar a tu hijo/a a manejar la frustraciÃ³n?",
                options: [
                    "Ignorando su frustraciÃ³n hasta que se le pase.",
                    "DiciÃ©ndole que no tiene motivos para frustrarse.",
                    "Validando su sentimiento y ofreciÃ©ndole estrategias para superarlo.",
                    "Haciendo la tarea por Ã©l/ella para evitarle la frustraciÃ³n."
                ],
                answer: "Validando su sentimiento y ofreciÃ©ndole estrategias para superarlo.",
                reflection: "La frustraciÃ³n es una parte natural de la vida. EnseÃ±ar a tus hijos/as a reconocerla y a desarrollar herramientas para afrontarla les equipa con una valiosa habilidad para la vida."
            },
            {
                question: "Â¿QuÃ© tipo de lenguaje es mÃ¡s efectivo para guiar el comportamiento de un niÃ±o/a?",
                options: [
                    "Un lenguaje lleno de amenazas y advertencias.",
                    "Un lenguaje positivo y descriptivo, centrado en lo que SÃ se puede hacer.",
                    "Un lenguaje confuso y ambiguo.",
                    "Un lenguaje crÃ­tico y descalificador."
                ],
                answer: "Un lenguaje positivo y descriptivo, centrado en lo que SÃ se puede hacer.",
                reflection: "El lenguaje que usamos da forma a la realidad de nuestros hijos/as. Un lenguaje positivo y descriptivo les ayuda a entender mejor lo que esperas y fomenta un ambiente de respeto y aprendizaje."
            },
            {
                question: "Â¿Por quÃ© es importante reconocer el esfuerzo de tu hijo/a, mÃ¡s allÃ¡ del resultado?",
                options: [
                    "Para que se vuelva dependiente de tu aprobaciÃ³n.",
                    "Demuestra que valoras su dedicaciÃ³n y perseverancia, no solo el Ã©xito.",
                    "Genera una expectativa de recompensa constante.",
                    "Desarrolla el narcisismo."
                ],
                answer: "Demuestra que valoras su dedicaciÃ³n y perseverancia, no solo el Ã©xito.",
                reflection: "El camino es tan importante como el destino. Al valorar el esfuerzo, enseÃ±as a tus hijos/as el poder de la perseverancia, la resiliencia y la alegrÃ­a de aprender y crecer, independientemente del resultado final."
            },
            {
                question: "Â¿CuÃ¡l es un beneficio de dedicar tiempo de calidad a tus hijos/as diariamente?",
                options: [
                    "Es una obligaciÃ³n que hay que cumplir.",
                    "Fortalece el vÃ­nculo afectivo y les hace sentir importantes y amados.",
                    "Solo es necesario cuando hay problemas o conflictos.",
                    "No es tan relevante como la cantidad de tiempo que se pasa con ellos."
                ],
                answer: "Fortalece el vÃ­nculo afectivo y les hace sentir importantes y amados.",
                reflection: "El tiempo de calidad es un tesoro. Dedicar momentos exclusivos a tus hijos/as, incluso si son cortos, nutre su bienestar emocional y les recuerda que son la prioridad en tu vida."
            }
        ];

        const motivationalQuotes = [
            "La paternidad y maternidad son un viaje de aprendizaje constante. Â¡Cada dÃ­a es una nueva oportunidad para crecer juntos!",
            "Ser padre/madre no es ser perfecto/a, es ser real. Tu amor y tu esfuerzo son mÃ¡s que suficientes.",
            "Recuerda que estÃ¡s construyendo recuerdos y sentando bases. Cada interacciÃ³n cuenta.",
            "En la crianza, la paciencia es una virtud y el amor es la brÃºjula.",
            "Tus hijos/as no necesitan un padre/madre perfecto/a, necesitan uno/a feliz, presente y que les ame incondicionalmente.",
            "El regalo mÃ¡s grande que puedes dar a tus hijos/as es el de tu tiempo y tu atenciÃ³n plena.",
            "Crianza es un acto de amor que se renueva cada dÃ­a.",
            "Con cada desafÃ­o, viene una oportunidad para modelar resiliencia y empatÃ­a.",
            "Eres el universo para tus hijos/as. Tu presencia, amor y guÃ­a marcan la diferencia.",
            "La magia de la crianza reside en los momentos pequeÃ±os y cotidianos."
        ];


        let currentQuestionIndex = 0;
        let score = 0;
        let selectedOption = null;

        // Get DOM elements
        const startScreen = document.getElementById('startScreen');
        const quizScreen = document.getElementById('quizScreen');
        const endScreen = document.getElementById('endScreen');

        const startButton = document.getElementById('startButton');
        const questionNumberElem = document.getElementById('questionNumber');
        const questionTextElem = document.getElementById('questionText');
        const optionsContainer = document.getElementById('optionsContainer');
        const feedbackContainer = document.getElementById('feedbackContainer');
        const feedbackTextElem = document.getElementById('feedbackText');
        const reflectionTextElem = document.getElementById('reflectionText');
        const nextButton = document.getElementById('nextButton');
        const progressFill = document.getElementById('progressFill');

        const finalScoreElem = document.getElementById('finalScore');
        const finalReflectionElem = document.getElementById('finalReflection');
        const motivationalQuoteElem = document.getElementById('motivationalQuote');
        const restartButton = document.getElementById('restartButton');
        const gameContainer = document.getElementById('gameContainer');

        // Event Listeners
        startButton.addEventListener('click', startGame);
        nextButton.addEventListener('click', nextQuestion);
        restartButton.addEventListener('click', restartGame);

        function startGame() {
            startScreen.classList.add('fade-out');
            setTimeout(() => {
                startScreen.classList.add('hidden');
                startScreen.classList.remove('fade-out');
                quizScreen.classList.remove('hidden');
                quizScreen.classList.add('fade-in');
                currentQuestionIndex = 0;
                score = 0;
                loadQuestion();
                updateProgressBar();
            }, 600); // Wait for fade-out to complete
        }

        function loadQuestion() {
            selectedOption = null; // Reset selected option
            feedbackContainer.classList.add('hidden');
            nextButton.classList.add('hidden');
            optionsContainer.innerHTML = ''; // Clear previous options

            const currentQuestion = questions[currentQuestionIndex];
            questionNumberElem.textContent = `Pregunta ${currentQuestionIndex + 1} de ${questions.length}`;
            questionTextElem.textContent = currentQuestion.question;

            currentQuestion.options.forEach(option => {
                const button = document.createElement('button');
                button.textContent = option;
                button.classList.add('btn', 'btn-option');
                button.addEventListener('click', () => selectOption(button, option, currentQuestion.answer));
                optionsContainer.appendChild(button);
            });

            // Re-enable all buttons in case they were disabled
            Array.from(optionsContainer.children).forEach(button => {
                button.disabled = false;
                button.classList.remove('selected', 'correct', 'incorrect');
            });
            updateProgressBar();
        }

        function selectOption(selectedButton, chosenOption, correctAnswer) {
            if (selectedOption !== null) {
                // If an option was already selected, prevent re-selection until next question
                return;
            }

            selectedOption = selectedButton;
            const isCorrect = chosenOption === correctAnswer;
            const buttons = optionsContainer.children;

            // Disable all buttons to prevent further clicks
            Array.from(buttons).forEach(button => {
                button.disabled = true;
            });

            // Highlight selected and correct/incorrect options
            selectedButton.classList.add('selected');
            if (isCorrect) {
                selectedButton.classList.add('correct');
                score++;
                showFeedback(true, questions[currentQuestionIndex].reflection);
                triggerConfetti(); // Trigger confetti for correct answer
            } else {
                selectedButton.classList.add('incorrect');
                // Highlight the correct answer
                Array.from(buttons).forEach(button => {
                    if (button.textContent === correctAnswer) {
                        button.classList.add('correct');
                    }
                });
                showFeedback(false, questions[currentQuestionIndex].reflection);
            }

            nextButton.classList.remove('hidden'); // Show next button
        }

        function showFeedback(isCorrect, reflection) {
            feedbackContainer.classList.remove('hidden');
            feedbackContainer.classList.remove('bg-green-100', 'bg-red-100', 'border-green-500', 'border-red-500'); // Reset colors
            feedbackTextElem.classList.remove('text-green-800', 'text-red-800'); // Reset colors

            if (isCorrect) {
                feedbackContainer.classList.add('bg-green-100', 'border-green-500');
                feedbackTextElem.classList.add('text-green-800');
                feedbackTextElem.textContent = "Â¡Correcto! âœ… Â¡Muy bien!";
            } else {
                feedbackContainer.classList.add('bg-red-100', 'border-red-500');
                feedbackTextElem.classList.add('text-red-800');
                feedbackTextElem.textContent = "Â¡Incorrecto! âŒ No te preocupes.";
            }
            reflectionTextElem.textContent = reflection;
            feedbackContainer.classList.add('fade-in'); // Trigger fade-in
        }

        function nextQuestion() {
            feedbackContainer.classList.add('fade-out'); // Fade out feedback
            nextButton.classList.add('fade-out'); // Fade out next button
            optionsContainer.classList.add('fade-out'); // Fade out options

            setTimeout(() => {
                feedbackContainer.classList.add('hidden');
                nextButton.classList.add('hidden');
                optionsContainer.classList.remove('fade-out'); // Remove fade-out class
                feedbackContainer.classList.remove('fade-out'); // Remove fade-out class
                nextButton.classList.remove('fade-out'); // Remove fade-out class

                currentQuestionIndex++;
                if (currentQuestionIndex < questions.length) {
                    loadQuestion();
                } else {
                    endGame();
                }
            }, 600); // Wait for fade-out to complete
        }

        function updateProgressBar() {
            const progress = (currentQuestionIndex / questions.length) * 100;
            progressFill.style.width = `${progress}%`;
        }

        function endGame() {
            quizScreen.classList.add('fade-out');
            setTimeout(() => {
                quizScreen.classList.add('hidden');
                quizScreen.classList.remove('fade-out');
                endScreen.classList.remove('hidden');
                endScreen.classList.add('fade-in');

                finalScoreElem.textContent = `${score} de ${questions.length}`;
                if (score === questions.length) {
                    finalReflectionElem.textContent = "Â¡Felicidades! Has demostrado un conocimiento excepcional y un gran compromiso con el fortalecimiento de tus competencias parentales. Â¡Eres un/a campeÃ³n/a de la crianza!";
                } else if (score >= questions.length * 0.7) {
                    finalReflectionElem.textContent = "Â¡Excelente trabajo! Has demostrado una gran comprensiÃ³n de las competencias parentales. ContinÃºa practicando y creciendo en este hermoso camino.";
                } else if (score >= questions.length * 0.4) {
                    finalReflectionElem.textContent = "Â¡Muy bien! Has respondido correctamente a muchas preguntas. Cada respuesta es una oportunidad para aprender y seguir desarrollando tus habilidades parentales.";
                }
                else {
                    finalReflectionElem.textContent = "Â¡No te desanimes! Cada pregunta es un paso hacia un mayor entendimiento. Sigue explorando y verÃ¡s cÃ³mo tus competencias parentales se fortalecen cada vez mÃ¡s.";
                }

                // Display a random motivational quote
                const randomQuote = motivationalQuotes[Math.floor(Math.random() * motivationalQuotes.length)];
                motivationalQuoteElem.textContent = randomQuote;

                triggerConfetti(true); // Trigger confetti for end game
            }, 600); // Wait for fade-out to complete
        }

        function restartGame() {
            endScreen.classList.add('fade-out');
            setTimeout(() => {
                endScreen.classList.add('hidden');
                endScreen.classList.remove('fade-out');
                startScreen.classList.remove('hidden');
                startScreen.classList.add('fade-in');
                currentQuestionIndex = 0;
                score = 0;
                selectedOption = null;
                // Clear any lingering confetti
                gameContainer.querySelectorAll('.confetti').forEach(c => c.remove());
            }, 600); // Wait for fade-out to complete
        }

        // Function to trigger confetti effect
        function triggerConfetti(isEndGame = false) {
            const numConfetti = isEndGame ? 150 : 50; // More confetti for end game
            for (let i = 0; i < numConfetti; i++) {
                const confetti = document.createElement('div');
                confetti.classList.add('confetti');
                // Distribute confetti around the center top for more visual appeal
                const startX = 40 + Math.random() * 20; // from 40% to 60% width
                confetti.style.left = `${startX}%`;
                confetti.style.top = `${Math.random() * -30}px`; // Start higher above the container
                confetti.style.animationDelay = `${Math.random() * 0.8}s`; // Longer delay range
                confetti.style.transform = `scale(${0.6 + Math.random() * 0.7})`; // Larger size range
                confetti.style.opacity = `${0.7 + Math.random() * 0.3}`; // Varying opacity
                gameContainer.appendChild(confetti);

                // Remove confetti after animation to prevent DOM clutter
                confetti.addEventListener('animationend', () => {
                    confetti.remove();
                });
            }
        }

        // Initial load
        window.onload = () => {
            // No initial action needed, start screen is visible by default.
            // This ensures all elements are loaded before event listeners are attached.
        };
    </script>
</body>
</html>

